<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <!-- jquery -->
  <script
  src="https://code.jquery.com/jquery-3.4.1.js"
  integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
  crossorigin="anonymous"></script>

  <!-- wav -->
  <script src="https://cdn.jsdelivr.net/npm/wavefile"></script>
</head>
<body>
  <form id="voice">
    <input type="text" name="text" id="text">
    <button id="button" type="submit">Play</button>
  </form>
  <audio controls id="audio">
    
  </audio>
  <script src="./script/index.js"></script>
  <script>
    // // $scope.player = new window.Audio();

    // // var xhr = new XMLHttpRequest();
    // // xhr.onreadystatechange = function() {
    // //     if (this.readyState == 4 && this.status == 200) {
    // //         $scope.player.src = window.URL.createObjectURL(this.response);
    // //         $scope.player.play();
    // //     }
    // // };
    // // xhr.open('POST', 'http://localhost:3000/voices');
    // // xhr.responseType = 'blob';
    // // xhr.send();

    // var xhr = new XMLHttpRequest();
    //   xhr.onreadystatechange = function(){
    //       if (this.readyState == 4 && this.status == 200){
    //           //this.response is what you're looking for
    //           // handler(this.response);
    //           console.log(this.response)
    //           // var i, l, d, array;
    //           // d = this.response;
    //           // l = d.length;
    //           // array = new Uint8Array(l);
    //           // for (var i = 0; i < l; i++){
    //           //     array[i] = d.charCodeAt(i);
    //           // }
    //           // var b = new Blob([array], {type: 'audio/wav'});
    //           // window.location.href = URL.createObjectURL(b);
    //           // var data = btoa(this.response);
                
    //           // console.log(this.response, typeof this.response);
    //           console.log(data)
    //           var img = document.getElementById('audio');
    //           // var url = window.URL || window.webkitURL;
    //           img.src = "data:audio/wav;base64," + data;
              
    //       }
    //   }
    //   xhr.open('POST', 'http://localhost:3000/voices');
    //   xhr.responseType = 'text/html';
    //   xhr.send();
    // $.ajax({
    //   url: 'http://localhost:3000/voices',
    //   method: 'POST'
    // })
    //   .done(function (r) {
    //     console.log(r)
    //     var reader = new FileReader()
    //     reader.onload = (function(self) {
    //       return function(e) {
    //         document.getElementById("audio").src = e.target.result;
    //       }
    //     })(this);
    //     reader.readAsDataURL(new Blob([r], {type: 'audio/wav'}));
    //   });



    //   //     const fileSelect = document.getElementById("fileSelect"),
    //   //     fileElem = document.getElementById("fileElem"),
    //   //     fileList = document.getElementById("fileList");

    //   // fileSelect.addEventListener("click", function (e) {
    //   //   if (fileElem) {
    //   //     fileElem.click();
    //   //   }
    //   //   e.preventDefault(); // prevent navigation to "#"
    //   // }, false);

    //   // fileElem.addEventListener("change", handleFiles, false); 

    //   // function handleFiles() {
    //   //   if (!this.files.length) {
    //   //     fileList.innerHTML = "<p>No files selected!</p>";
    //   //   } else {
    //   //     fileList.innerHTML = "";
    //   //     const list = document.createElement("ul");
    //   //     fileList.appendChild(list);
    //   //     for (let i = 0; i < this.files.length; i++) {
    //   //       const li = document.createElement("li");
    //   //       list.appendChild(li);
            
      //       const img = document.createElement("audio");
      //       img.src = URL.createObjectURL(this.files[i]);
      //       img.height = 60;
      //       img.onload = function() {
      //         URL.revokeObjectURL(this.src);
      //       }
      //       li.appendChild(img);
      //       const info = document.createElement("span");
      //       info.innerHTML = this.files[i].name + ": " + this.files[i].size + " bytes";
      //       li.appendChild(info);
      //     }
      //   }
      // }
  </script>
</div>
</body>
</html>